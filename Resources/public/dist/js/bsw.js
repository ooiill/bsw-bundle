/*! Anyone */
/*! BackendSteeringWheel4AntD - v0.0.1 - 2021-07-14 */
"use strict";function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};window.bsw=new FoundationAntD(jQuery,Vue,antd,window.lang||{}),$(function(){bsw.vue().template(bsw.config.template||null).data(Object.assign({bsw:bsw,locale:bsw.d.locales[bsw.lang.i18n_ant],timeFormat:"YYYY-MM-DD HH:mm:ss",submitFormUrl:null,submitFormMethod:null,ckEditor:{},loadTimes:1,noLoadingOnce:!1,spinning:!1,vConsole:null,constTrue:!0,constFalse:!1,init:{configure:{},message:{},modal:{},result:{}},footer:"footer",modal:{},modalMeta:{visible:!0,centered:!0},drawer:{},drawerMeta:{visible:!0},result:{},resultMeta:{visible:!0},WH:bsw.getWH()},bsw.config.data)).computed(Object.assign({},bsw.config.computed||{})).method(Object.assign({moment:moment,redirectByVue:function(a){bsw.redirect(bsw.getBswData($(a.item.$el).find("span")))},dispatcherByNative:function(a){bsw.dispatcherByBswData(bsw.getBswData($(a)),a)},dispatcherByVue:function(a){this.dispatcherByNative($(a.target)[0])},showIFrameByNative:function(a){bsw.showIFrame(bsw.getBswData($(a)),a)},showIFrameByVue:function(a){this.showIFrameByNative($(a.target)[0])},tabsLinksSwitch:function(a){bsw.redirect(bsw.getBswData($("#tabs_link_"+a)))},selectedRowHandler:function(a){for(var b=[],c=0;c<this.previewSelectedRow.length;c++)bsw.isString(this.previewSelectedRow[c])&&(b[c]=bsw.evalExpr(this.previewSelectedRow[c]),a&&(b[c]=b[c][a]||null));return b},multipleAction:function(a,b){var c=this,d=this.selectedRowHandler();return 0===d.length?bsw.warning(bsw.lang.select_item_first):void bsw.request(a.location,{ids:d}).then(function(b){bsw.response(b).then(function(){bsw.responseLogic(b)}).catch(function(a){console.warn(a)}),"undefined"!=typeof a.refresh&&a.refresh&&c.previewPaginationRefresh(!1)}).catch(function(a){console.warn(a)})},showIFrameWithChecked:function(a,b){var c=this.selectedRowHandler(a.selector).join(","),d={ids:c};if("undefined"!=typeof a.form){var e="fill["+a.form+"]";d=_defineProperty({},e,c)}a.location=bsw.setParams(d,a.location),bsw.showIFrame(a,b)},fillParentForm:function(a,b){return a.ids=this.selectedRowHandler(a.selector).join(","),0===a.ids.length?bsw.warning(bsw.lang.select_item_first):void parent.postMessage(a,"*")},verifyJsonFormat:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"persistenceForm",d=this[c].getFieldValue(a.field),e=bsw.setParams(_defineProperty({},a.key,d),a.url);window.open(e)},setUrlToForm:function(a,b){this.submitFormUrl=a.location,this.submitFormMethod=$(b).attr("bsw-method")},previewGetUrl:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a=a||this.previewUrl,bsw.setParams(Object.assign({page:this.previewPageNumber},b),a)},previewPaginationRefresh:function(a){this.noLoadingOnce=!0,this.pagination(this.previewGetUrl(),null,a)},previewImageChange:function(){var a=this;if(0!==a.previewColumns.length)var b=setInterval(function(){return c()},50),c=function(){var c=$("img"),d=0;c.each(function(){d+=this.complete?1:0});var e=a.previewColumns[0].fixed;a.previewColumns[0].fixed=!e,a.previewColumns[0].fixed=e,(d>=c.length||0===c.length)&&clearInterval(b)}},pagination:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=this;return b&&(a=bsw.setParams({page:b},a)),c||"undefined"==typeof d.previewList||0===d.previewList.length?location.href=a:void bsw.request(a).then(function(c){bsw.response(c).then(function(){d.previewList=c.sets.preview.list,d.previewPageNumber=b,d.previewUrl=a,d.previewPaginationData=c.sets.preview.page,d.previewImageChange(),bsw.responseLogic(c),bsw.cnf.v.$nextTick(function(){bsw.initUpwardInfect(),d.doubleClickForEdit()}),history.replaceState({},"",a)}).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})},filterFormAction:function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=arguments[2],d=arguments[3],e=this;a.preventDefault(),e[c].validateFields(function(a,c){if(a)return!1;for(var f in c)if(c.hasOwnProperty(f)){if(moment.isMoment(c[f])){var g=c[f]._f||e[d][f];c[f]=c[f].format(g),b=!0}if(bsw.isArray(c[f]))for(var h=0;h<c[f].length;h++)if(moment.isMoment(c[f][h])){var i=c[f][h]._f||e[d][f];c[f][h]=c[f][h].format(i),b=!0}}var j={};for(var k in c)c.hasOwnProperty(k)&&"undefined"!=typeof c[k]&&null!=c[k]&&0!==c[k].length&&(j[k]=c[k]);return e[e.submitFormMethod+"FilterForm"](j,b)})},searchFilterForm:function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c={},d=bsw.unsetParamsBeginWith(["filter"]);d=bsw.unsetParams(["page"],d,!1,c),d=bsw.setParams({filter:a},d),_typeof(c.page)&&c.page>1&&(b=!0),this.pagination(d,null,b)},exportFilterForm:function(a){var b=this,c=bsw.unsetParamsBeginWith(["filter"]);c=bsw.unsetParams(["page"],c),c=bsw.setParams({filter:a,scene:"export"},c),bsw.request(c).then(function(a){bsw.response(a).then(function(){var c={title:bsw.lang.export_mission,width:500,height:385};c.location=bsw.setParams(a.sets,b.init.exportApiUrl,!0),bsw.showIFrame(c,$("body")[0]),bsw.responseLogic(a)}).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})},submitFormAction:function(a,b,c){var d=this;a.preventDefault(),d[b].validateFields(function(a,e){if(a)return!1;for(var f in e)if(e.hasOwnProperty(f)){if(moment.isMoment(e[f])){var g=e[f]._f||d[c][f];e[f]=e[f].format(g)}if(bsw.isArray(e[f]))for(var h=0;h<e[f].length;h++)if(moment.isMoment(e[f][h])){var i=e[f][h]._f||d[c][f];e[f][h]=e[f][h].format(i)}bsw.checkJsonDeep(e,f+".fileList")&&delete e[f]}var j=b+"ExtraValues";return"undefined"!=typeof d[j]&&(e=Object.assign(e,d[j])),d[d.submitFormMethod+"PersistenceForm"](e)})},submitPersistenceForm:function(a){bsw.request(this.submitFormUrl,{submit:a}).then(function(a){var b=bsw.parseQueryString();if(b.iframe){a.sets.arguments=bsw.parseQueryString();var c=a.sets.function||"handleResponse";parent.postMessage({response:a,function:c},"*")}else bsw.response(a).then(function(){bsw.responseLogic(a)}).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})},uploaderChange:function(a,b){var c=a.file,d=a.fileList,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"persistenceForm";"done"===c.status?this.spinning=!1:"uploading"===c.status&&(this.spinning=!0);var f=this.persistenceFileListKeyCollect[b];if(!c.response)return void(f.list=d);c.response.error&&(f.list=d.slice(0,-1));var g=f.list.slice(-1);if(g.length){var h,i=g[0].response.sets,j=(h={},_defineProperty(h,f.id,"attachment_id"),_defineProperty(h,f.md5,"attachment_md5"),_defineProperty(h,f.sha1,"attachment_sha1"),_defineProperty(h,f.url,"attachment_url"),h);for(var k in j)if(j.hasOwnProperty(k)&&k&&j[k]){if(0===$("#"+k).length)continue;this[e]&&this[e].setFieldsValue(_defineProperty({},k,i[j[k]]))}}if("undefined"!=typeof c.response.code&&500!==c.response.code||(this.spinning=!1),c.response.sets.href){var l=c.response.sets.function||"handleResponse";parent.postMessage({response:c.response,function:l},"*")}else bsw.response(c.response).then(function(){bsw.responseLogic(c.response)}).catch(function(a){console.warn(a)})},changeTriggerHideForInput:function(a,b){this.changeTriggerHide(a.target.value,{},b)},changeTriggerHideForSelect:function(a,b,c){this.changeTriggerHide(a,c)},changeTriggerHide:function(a,b){var c=this.persistenceFieldHideNow,d=this.persistenceFieldHideCollect[b];for(var e in d)d.hasOwnProperty(e)&&(c[e]=d[e].includes(a.toString()))},changeTriggerDisabledForInput:function(a,b){this.changeTriggerDisabled(a.target.value,{},b)},changeTriggerDisabledForSelect:function(a,b,c){this.changeTriggerDisabled(a,c)},changeTriggerDisabled:function(a,b){var c=this.persistenceFieldDisabledNow,d=this.persistenceFieldDisabledCollect[b];for(var e in d)d.hasOwnProperty(e)&&(c[e]=d[e].includes(a.toString()))},requestByAjax:function(a,b){var c=this;"undefined"!=typeof a.confirmIsCheck&&(a.location=bsw.setParams({checkbox:a.confirmIsCheck?1:0},a.location)),bsw.request(a.location,a).then(function(b){bsw.response(b).then(function(){bsw.responseLogic(b)}).catch(function(a){console.warn(a)}),"undefined"!=typeof a.refresh&&a.refresh&&c.previewPaginationRefresh(!1)}).catch(function(a){console.warn(a)})},urlParamsTrigger:function(a){location.href=bsw.triggerParams(a.params,null,!0)},doubleClickForEdit:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".bsw-inline-edit-input",b=this,c=function(a,c){var d=bsw.getBswData(a);d.postValue=c.val(),b.noLoadingOnce=!0,bsw.request(a.data("api"),d).then(function(e){bsw.response(e).then(function(){bsw.responseLogic(e)}).catch(function(a){console.warn(a)}),a.removeClass("active").attr("title",bsw.lang.double_click_for_edit),c.attr("disabled",!0),"undefined"!=typeof d.refresh&&d.refresh&&b.previewPaginationRefresh(!1),"undefined"!=typeof e.sets.args&&a.data("bsw",e.sets.args)}).catch(function(a){console.warn(a)})};$(a).each(function(){var a=$(this);a.off("dblclick").on("dblclick",function(){a.addClass("active").attr("title",bsw.lang.enter_for_save);var b=a.find("input");b.attr("disabled",!1).focus(),b.off("keypress").on("keypress",function(d){13===d.keyCode&&c(a,b)})})})},dynamicDataSourceBySearch:function(a,b){var c=this;"undefined"==typeof this.ddsCore&&(this.ddsCore=bsw.debounce(200,function(a){var b=$("#"+a.field),d=b.data("do-logic-api"),e=b.data("do-dds-field");c.noLoadingOnce=!0,bsw.request(d,a).then(function(a){bsw.response(a).then(function(){if(e&&a.sets){bsw.setJsonDeep(c,e,a.sets);var b=e.split(".");b=b[b.length-1],c.persistenceForm.setFieldsValue(_defineProperty({},b,void 0))}bsw.responseLogic(a)}).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})})),this.ddsCore({value:a,field:b})},dynamicDataSourceByChange:function(a,b,c){var d=this,e=$("#"+c),f=e.data("do-logic-api"),g=e.data("do-dds-field");d.noLoadingOnce=!0,bsw.request(f,{value:a,field:c}).then(function(a){bsw.response(a).then(function(){if(g&&a.sets){bsw.setJsonDeep(d,g,a.sets);var b=g.split(".");b=b[b.length-1],d.persistenceForm.setFieldsValue(_defineProperty({},b,void 0))}bsw.responseLogic(a)}).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})},dynamicValueByChange:function(a,b,c){var d=this,e=$("#"+c),f=e.data("do-logic-api"),g=e.data("do-change-field");d.noLoadingOnce=!0,bsw.request(f,{value:a,field:c}).then(function(a){bsw.response(a).then(function(){g&&a.sets&&d.persistenceForm.setFieldsValue(_defineProperty({},g,a.sets.change)),bsw.responseLogic(a)}).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})},copyFileLink:function(a,b){this.copy=a.link},getFormDataByEvent:function(a){var b=a.target.id,c=a.target.value,d=bsw.getBswData($(a.target)),e=d.form||"persistenceForm";return{field:b,value:c,data:d,form:e}},refreshPreviewForParent:function(){parent.postMessage({function:"refreshPreview"},"*")},refreshPreviewInParent:function(a,b){bsw.handleResponseInParent(a,b),this.previewPaginationRefresh(!1)}},bsw.config.method||{})).directive(Object.assign({init:{bind:function(a,b,c){var d="";b.arg.startsWith("data-")&&(d="data",b.arg=b.arg.substr(5));var e=bsw.smallHump(b.arg,"-"),f=b.value||b.expression;if("configure"===e)bsw.cnf=Object.assign(bsw.cnf,f);else if("data"===d){var g=null;if(e.indexOf(":")>-1){var h=e.split(":"),i=_slicedToArray(h,2);e=i[0],g=i[1]}g&&g.length>0?c.context[e][bsw.lcFirst(g)]=f:c.context[e]=f}else c.context.init[e]=f}}},bsw.config.directive||{})).watch(Object.assign({},bsw.config.watch||{})).component(Object.assign({"b-icon":bsw.d.Icon.createFromIconfontCN({scriptUrl:$("#var-font-symbol").data("bsw-value")})},bsw.config.component||{})).init(function(a){var b=!1;a.scaffoldInit&&(b=a.scaffoldInit()),bsw.initClipboard(),bsw.initUpwardInfect(),a.doubleClickForEdit(),bsw.initHighlight(),bsw.initVConsole();var c=b?1200:600;setTimeout(function(){bsw.initScrollX(),$(window).resize();var b=function(){bsw.messageAutoDiscovery(a.init),bsw.autoIFrameHeight(),a.loadTimes+=1},c=$(".bsw-page-loading");c.length?c.fadeOut(300,function(){return b()}):b(),a.WH=bsw.getWH()},c)}),window.addEventListener("message",function(a){a.data.function+="InParent",bsw.dispatcherByBswData(a.data,$("body")[0])},!1)});